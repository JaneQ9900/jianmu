cron: '* 5/* * * * ? *'

event:
  push_event:
    branch: ${branch_name} # dev, master
  tag_event:
    tag: ${branch_name} # tag_name

param:
  branch_name: master
  git_site: gitee.com

workflow:
  name: 测试流程1
  ref: flow_1
  description: 测试流程1的描述1
  Start_1:
    type: start
    targets:
      - Git_1
  Git_1:
    type: git_clone0.4
    sources:
      - Start_1
    targets:
      - Build_1
    param:
      commit_branch: ${branch_name}
      remote_url: https://gitee.com/jianmu_dev/jianmu-workflow-core.git
      netrc_machine: ${git_site}
      netrc_username: ((gitee.user))
      netrc_password: ((gitee.pass))
  Build_1:
    type: maven13
    sources:
      - Git_1
    targets:
      - Condition_1
    param:
      cmd: mvn install
  Condition_1:
    type: condition
    sources:
      - Build_1
    expression: Git_1["commit_branch"] == "dev"
    cases:
      false: Notice_1
      true: Notice_2
  Notice_1:
    type: maven11
    param:
      text: '"Build error, msg is: " + ${Build_1.build_error_message}'
    sources:
      - Condition_1
    targets:
      - End_1
  Notice_2:
    type: maven12
    param:
      text: ${Build_1.build_info}
    sources:
      - Condition_1
    targets:
      - End_1
  End_1:
    type: end
    sources:
      - Notice_1
      - Notice_2
